# Web Crawler Local Development Configuration
# Use this file for local testing with Docker Desktop Kubernetes

# Global settings
global:
  namespace: web-crawler

# Neo4j configuration
neo4j:
  enabled: true
  neo4j:
    name: crawler-neo4j
    password: "password"
    acceptLicenseAgreement: "yes"
    resources:
      cpu: "0.5"
      memory: "2Gi"

  volumes:
    data:
      mode: dynamic
      dynamic:
        storageClassName: "standard"  # Docker Desktop default StorageClass
        requests:
          storage: 3Gi

  services:
    neo4j:
      enabled: true
      type: NodePort
      ports:
        http:
          enabled: true
          nodePort: 30074
        bolt:
          enabled: true
          nodePort: 30087

# Feeder configuration - using local ARM64 images
feeder:
  enabled: true
  replicaCount: 8

  image:
    repository: ghcr.io/bluedotiya/web_crawler/feeder
    tag: local-arm64-v2  # Local build for ARM64 with env var fix
    pullPolicy: Never  # Use local images only

  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"

  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    fsGroup: 1000

  livenessProbe:
    enabled: false

  readinessProbe:
    enabled: false

  env:
    NEO4J_DNS_NAME: "web-crawler.web-crawler.svc.cluster.local:7687"
    NEO4J_USERNAME: "neo4j"
    NEO4J_PASSWORD: "password"

# Manager configuration - using local ARM64 images
manager:
  enabled: true
  replicaCount: 1

  image:
    repository: ghcr.io/bluedotiya/web_crawler/manager
    tag: local-arm64-v2  # Local build for ARM64 with env var fix
    pullPolicy: Never  # Use local images only

  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"

  securityContext:
    runAsNonRoot: false  # Flask runs on port 80
    runAsUser: 0

  service:
    type: NodePort
    port: 80
    targetPort: 80
    nodePort: 30080

  livenessProbe:
    enabled: false  # Disabled - endpoint only accepts POST

  readinessProbe:
    enabled: false  # Disabled - endpoint only accepts POST

  env:
    NEO4J_DNS_NAME: "web-crawler.web-crawler.svc.cluster.local:7687"
    NEO4J_USERNAME: "neo4j"
    NEO4J_PASSWORD: "password"
