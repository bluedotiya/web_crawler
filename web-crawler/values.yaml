# Web Crawler Unified Configuration

# Global settings
global:
  namespace: web-crawler

# Neo4j configuration
neo4j:
  enabled: true
  neo4j:
    name: crawler-neo4j
    password: "password"
    acceptLicenseAgreement: "yes"
    resources:
      cpu: "0.5"
      memory: "2Gi"

  volumes:
    data:
      mode: dynamic
      dynamic:
        # Use cluster default StorageClass or specify:
        # storageClassName: "standard"     # Minikube/GKE
        # storageClassName: "gp3"          # AWS EBS
        # storageClassName: "managed-premium"  # Azure
        storageClassName: "standard"
        requests:
          storage: 3Gi

  services:
    neo4j:
      enabled: true
      type: NodePort
      ports:
        http:
          enabled: true
          nodePort: 30074
        bolt:
          enabled: true
          nodePort: 30087

# Feeder configuration
feeder:
  enabled: true
  replicaCount: 8

  image:
    repository: ghcr.io/bluedotiya/web-crawler/feeder
    tag: latest
    pullPolicy: IfNotPresent

  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"

  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    fsGroup: 1000

  livenessProbe:
    enabled: true
    httpGet:
      path: /health
      port: 8081
    initialDelaySeconds: 10
    periodSeconds: 15
    timeoutSeconds: 5

  readinessProbe:
    enabled: false

  env:
    NEO4J_DNS_NAME: "crawler-neo4j-lb-neo4j.web-crawler.svc.cluster.local:7687"

  secretName: neo4j-credentials

# Manager configuration
manager:
  enabled: true
  replicaCount: 1

  image:
    repository: ghcr.io/bluedotiya/web-crawler/manager
    tag: latest
    pullPolicy: IfNotPresent

  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"

  securityContext:
    runAsNonRoot: true
    runAsUser: 1000

  service:
    type: ClusterIP
    port: 80
    targetPort: 8080

  livenessProbe:
    enabled: true
    httpGet:
      path: /health
      port: 8080
    initialDelaySeconds: 10
    periodSeconds: 15
    timeoutSeconds: 5

  readinessProbe:
    enabled: true
    httpGet:
      path: /ready
      port: 8080
    initialDelaySeconds: 5
    periodSeconds: 10
    timeoutSeconds: 5

  env:
    NEO4J_DNS_NAME: "crawler-neo4j-lb-neo4j.web-crawler.svc.cluster.local:7687"

  secretName: neo4j-credentials

# Frontend configuration
frontend:
  enabled: true
  replicaCount: 1

  image:
    repository: ghcr.io/bluedotiya/web-crawler/frontend
    tag: latest
    pullPolicy: IfNotPresent

  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "128Mi"
      cpu: "200m"

  podSecurityContext:
    runAsNonRoot: true
    runAsUser: 101
    fsGroup: 101

  service:
    type: NodePort
    port: 80
    targetPort: 8080
    nodePort: 30080
